<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaka Faisya Web (Galeri Lengkap)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loader {
            border: 4px solid #3d4a66;
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .json-output {
            background-color: #1a202c;
            border: 1px solid #2d3748;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 0.75rem;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
        }
        .tab-btn.active {
            background-color: #1f2937;
            border-color: #4b5563;
        }
    </style>
</head>
<body class="bg-black text-indigo-200">

    <div id="login-form" class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-gray-900 p-8 rounded-2xl shadow-lg border border-gray-700 w-full max-w-sm text-center">
            <h1 class="text-3xl font-bold mb-4 text-blue-800">Selamat Datang</h1>
            <p class="text-indigo-300 mb-6">Masukkan sandi untuk melanjutkan</p>
            <div class="space-y-4">
                <input type="password" id="passwordInput" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Sandi">
                <button id="loginBtn" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600 transition duration-300 transform hover:scale-105">
                    Masuk
                </button>
            </div>
            <p id="loginError" class="text-red-400 mt-4 h-4"></p>
        </div>
    </div>

    <div id="main-content" class="container mx-auto p-4 md:p-8 max-w-7xl hidden">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-blue-800">Kaka Faisya Web</h1>
            <p class="text-indigo-300 mt-2 text-lg">Buat video sinematik atau JSON scene.</p>
        </header>

        <main class="bg-gray-900 p-6 md:p-8 rounded-2xl shadow-lg border border-gray-700">
            
            <div class="flex mb-8 space-x-4 flex-wrap gap-2">
                <button id="videoTabBtn" class="tab-btn active px-6 py-3 rounded-xl font-bold text-white transition duration-300 border border-transparent hover:border-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600">
                    <i class="fa fa-film mr-2"></i> Video Generator
                </button>
                <button id="imageTabBtn" class="tab-btn px-6 py-3 rounded-xl font-bold text-white transition duration-300 border border-transparent hover:border-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600">
                    <i class="fa fa-image mr-2"></i> Image Generator
                </button>
                <button id="jsonTabBtn" class="tab-btn px-6 py-3 rounded-xl font-bold text-white transition duration-300 border border-transparent hover:border-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600">
                    <i class="fa-solid fa-code mr-2"></i> JSON Generator
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <div>
                        <label for="apiKey" class="block text-sm font-medium text-indigo-200 mb-1">API Key Anda</label>
                        <div class="flex items-center">
                            <input type="password" id="apiKey" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Masukkan API key Anda...">
                            <button id="toggleApiKey" class="p-3 ml-2 text-gray-400 hover:text-indigo-400">
                                <i class="fa fa-eye"></i>
                            </button>
                        </div>
                        <button id="saveApiBtn" class="mt-3 w-full bg-indigo-500 text-white py-2 px-4 rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-300">
                            Simpan Kunci
                        </button>
                        <p id="apiKeyStatus" class="text-xs text-green-400 mt-2 h-4"></p>
                    </div>

                    <div id="videoControls">
                        <div class="mt-6">
                            <label for="modelSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Model Veo</label>
                            <select id="modelSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="Veo 2">Veo 2</option>
                                <option value="Veo 3">Veo 3</option>
                                <option value="Veo 3 Fast" selected>Veo 3 Fast</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="ratioSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Rasio Video</label>
                            <select id="ratioSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="16:9" selected>16:9 (Horizontal)</option>
                                <option value="9:16">9:16 (Vertikal)</option>
                                <option value="1:1">1:1 (Persegi)</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="resolutionSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Resolusi Video</label>
                            <select id="resolutionSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="720p" selected>720p (HD)</option>
                                <option value="1080p">1080p (Full HD)</option>
                            </select>
                        </div>
                    </div>
                    <div id="imageControls" class="hidden">
                        <div class="mt-6">
                            <label for="imageModelSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Model Gambar</label>
                            <select id="imageModelSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="Gemini-Image">Gemini-Image</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="imageRatioSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Rasio Gambar</label>
                            <select id="imageRatioSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="1:1" selected>1:1 (Persegi)</option>
                                <option value="16:9">16:9 (Horizontal)</option>
                                <option value="9:16">9:16 (Vertikal)</option>
                            </select>
                        </div>
                    </div>
                    <div id="jsonControls" class="hidden">
                        <div class="mt-6">
                            <label for="numberOfScenes" class="block text-sm font-medium text-indigo-200 mb-1">Jumlah Adegan</label>
                            <select id="numberOfScenes" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5" selected>5</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="modelSelectJson" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Model Veo</label>
                            <select id="modelSelectJson" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="Veo 2">Veo 2</option>
                                <option value="Veo 3">Veo 3</option>
                                <option value="Veo 3 Fast" selected>Veo 3 Fast</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="languageSelectJson" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Bahasa Prompt</label>
                            <select id="languageSelectJson" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="indonesia" selected>Indonesia</option>
                                <option value="english">Inggris</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="visualStyleSelect" class="block text-sm font-medium text-indigo-200 mb-1">Pilih Gaya Visual</label>
                            <select id="visualStyleSelect" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                <option value="cinematic" selected>Sinematik</option>
                                <option value="anime">Anime</option>
                                <option value="photorealistic">Fotorealistik</option>
                                <option value="lainnya">Lainnya...</option>
                            </select>
                        </div>
                        <div id="customStyleInput" class="mt-4 hidden">
                             <label for="customStyle" class="block text-sm font-medium text-indigo-200 mb-1">Gaya Kustom</label>
                             <input type="text" id="customStyle" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Contoh: noir, cyberpunk">
                         </div>
                    </div>
                </div>
                
                <div class="md:col-span-2">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2 text-blue-800">Input Prompt</h2>
                    <label for="promptsInput" class="block text-sm font-medium text-indigo-200 mb-1">Masukkan setiap prompt pada baris baru.</label>
                    <textarea id="promptsInput" rows="10" class="w-full p-3 bg-gray-800 text-indigo-200 border border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Contoh:
Seekor anjing golden retriever bermain skateboard di taman.
Kucing oren berjalan di atas atap rumah.
Anak-anak bermain layang-layang saat matahari terbenam."></textarea>
                    
                    <button id="generateBtn" class="mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600 transition duration-300 transform hover:scale-105">
                        <i class="fa fa-film mr-2"></i> Buat Semua Video
                    </button>
                    <button id="generateImageBtn" class="hidden mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600 transition duration-300 transform hover:scale-105">
                        <i class="fa fa-image mr-2"></i> Buat Semua Gambar
                    </button>
                    <button id="generateJsonBtn" class="hidden mt-4 w-full bg-indigo-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-800 transition duration-300 transform hover:scale-105">
                        <i class="fa-solid fa-code mr-2"></i> Hasilkan JSON Scene
                    </button>

                    <section id="jsonOutputSection" class="mt-6 hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-gray-300">JSON Scene Output</h2>
                            <button id="copyJsonBtn" class="bg-indigo-600 text-white text-sm py-1.5 px-4 rounded-lg hover:bg-indigo-700 transition">
                                <i class="fa-regular fa-copy mr-2"></i> Salin
                            </button>
                        </div>
                        <pre class="json-output overflow-auto text-sm" id="jsonOutput"></pre>
                    </section>
                </div>
            </div>

            <section class="mt-8">
                <h2 class="text-xl font-bold mb-4 border-b pb-2 text-blue-800">Hasil</h2>
                <div id="resultsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Video/image slots will be dynamically managed here -->
                </div>
                <div id="noResultsMessage" class="hidden text-center text-gray-500 p-8">
                    <i class="fa fa-video fa-3x mb-2" id="resultsIcon"></i>
                    <p id="resultsText">Video yang Anda buat akan muncul di sini.</p>
                </div>
                <div id="globalErrorMessage" class="hidden text-center text-red-400 font-medium p-4">
                    <i class="fa fa-exclamation-triangle fa-2x mb-2"></i>
                    <p id="globalErrorText"></p>
                </div>
            </section>
        </main>

        <section class="mt-12">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-300">Galeri Contoh</h2>
            <div id="gallery" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
        </section>
        
        <footer class="text-center mt-12 text-sm text-gray-600">
            <p>Dibuat sebagai konsep untuk Veo AI. Ini adalah aplikasi demo dan tidak terhubung ke API Google Veo.</p>
        </footer>

    </div>

    <script>
        const loginForm = document.getElementById('login-form');
        const mainContent = document.getElementById('main-content');
        const passwordInput = document.getElementById('passwordInput');
        const loginBtn = document.getElementById('loginBtn');
        const loginError = document.getElementById('loginError');

        const videoTabBtn = document.getElementById('videoTabBtn');
        const imageTabBtn = document.getElementById('imageTabBtn');
        const jsonTabBtn = document.getElementById('jsonTabBtn');
        const videoControls = document.getElementById('videoControls');
        const imageControls = document.getElementById('imageControls');
        const jsonControls = document.getElementById('jsonControls');
        const generateBtn = document.getElementById('generateBtn');
        const generateImageBtn = document.getElementById('generateImageBtn');
        const generateJsonBtn = document.getElementById('generateJsonBtn');

        const correctPassword = 'kaka';

        loginBtn.addEventListener('click', () => {
            if (passwordInput.value === correctPassword) {
                loginForm.classList.add('hidden');
                mainContent.classList.remove('hidden');
            } else {
                loginError.textContent = 'Sandi salah. Coba lagi.';
            }
        });

        videoTabBtn.addEventListener('click', () => {
            videoTabBtn.classList.add('active');
            imageTabBtn.classList.remove('active');
            jsonTabBtn.classList.remove('active');
            videoControls.classList.remove('hidden');
            imageControls.classList.add('hidden');
            jsonControls.classList.add('hidden');
            generateBtn.classList.remove('hidden');
            generateImageBtn.classList.add('hidden');
            generateJsonBtn.classList.add('hidden');
            resultsIcon.className = 'fa fa-film fa-3x mb-2';
            resultsText.textContent = 'Video yang Anda buat akan muncul di sini.';
            resultsGrid.innerHTML = '';
            noResultsMessage.classList.remove('hidden');
        });

        imageTabBtn.addEventListener('click', () => {
            imageTabBtn.classList.add('active');
            videoTabBtn.classList.remove('active');
            jsonTabBtn.classList.remove('active');
            imageControls.classList.remove('hidden');
            videoControls.classList.add('hidden');
            jsonControls.classList.add('hidden');
            generateImageBtn.classList.remove('hidden');
            generateBtn.classList.add('hidden');
            generateJsonBtn.classList.add('hidden');
            resultsIcon.className = 'fa fa-image fa-3x mb-2';
            resultsText.textContent = 'Gambar yang Anda buat akan muncul di sini.';
            resultsGrid.innerHTML = '';
            noResultsMessage.classList.remove('hidden');
        });

        jsonTabBtn.addEventListener('click', () => {
            jsonTabBtn.classList.add('active');
            videoTabBtn.classList.remove('active');
            imageTabBtn.classList.remove('active');
            jsonControls.classList.remove('hidden');
            videoControls.classList.add('hidden');
            imageControls.classList.add('hidden');
            generateJsonBtn.classList.remove('hidden');
            generateBtn.classList.add('hidden');
            generateImageBtn.classList.add('hidden');
            noResultsMessage.classList.add('hidden');
            jsonOutputSection.classList.add('hidden');
        });

        const apiKeyInput = document.getElementById('apiKey');
        const toggleApiKeyBtn = document.getElementById('toggleApiKey');
        const saveApiBtn = document.getElementById('saveApiBtn');
        const apiKeyStatus = document.getElementById('apiKeyStatus');
        const promptsInput = document.getElementById('promptsInput');
        const resultsGrid = document.getElementById('resultsGrid');
        const noResultsMessage = document.getElementById('noResultsMessage');
        const resultsIcon = document.getElementById('resultsIcon');
        const resultsText = document.getElementById('resultsText');
        const globalErrorMessage = document.getElementById('globalErrorMessage');
        const globalErrorText = document.getElementById('globalErrorText');
        const gallery = document.getElementById('gallery');

        const modelSelect = document.getElementById('modelSelect');
        const ratioSelect = document.getElementById('ratioSelect');
        const resolutionSelect = document.getElementById('resolutionSelect');
        
        const imageModelSelect = document.getElementById('imageModelSelect');
        const imageRatioSelect = document.getElementById('imageRatioSelect');
        
        const numberOfScenesSelect = document.getElementById('numberOfScenes');
        const modelSelectJson = document.getElementById('modelSelectJson');
        const languageSelectJson = document.getElementById('languageSelectJson');
        const visualStyleSelect = document.getElementById('visualStyleSelect');
        const customStyleInput = document.getElementById('customStyleInput');
        const customStyle = document.getElementById('customStyle');
        const jsonOutputSection = document.getElementById('jsonOutputSection');
        const jsonOutput = document.getElementById('jsonOutput');
        const copyJsonBtn = document.getElementById('copyJsonBtn');

        let isApiSaved = false;

        const sampleData = {
            videos: [
                {
                    prompt: "Drone footage of a gigantic mythical crystalline creature walking through a snowy mountain landscape.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4"
                },
                {
                    prompt: "A delicious-looking hamburger assembling itself ingredient by ingredient, hyper-detailed, cinematic studio lighting.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4"
                },
                {
                    prompt: "Pemandangan gunung salju di pagi hari yang indah, dengan kabut tipis di atas pepohonan.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4"
                },
                {
                    prompt: "A futuristic car driving through a neon-lit city at night, with rain reflecting the lights on the street.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4"
                },
                {
                    prompt: "A close-up of a blooming rose, timelapse, showing every petal unfurling in detail.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                },
                {
                    prompt: "Two robots playfully chasing each other through a lush, overgrown forest.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4"
                },
                {
                    prompt: "Seorang peselancar menangkap ombak besar di Pasifik.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"
                },
                {
                    prompt: "Pemandangan kota Tokyo saat malam hari, dengan lampu neon yang berkedip-kedip.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4"
                },
                {
                    prompt: "Seekor panda yang lucu sedang makan bambu.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/WhatCarCanYouGetForAGrand.mp4"
                },
                {
                    prompt: "Seekor burung hantu terbang melintasi hutan di malam hari.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4"
                },
                {
                    prompt: "Sebuah roket diluncurkan ke luar angkasa, menembus awan dan menuju bintang-bintang.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscape.mp4"
                },
                {
                    prompt: "Kembang api meledak di langit, memancarkan warna-warni yang cerah.",
                    videoUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4"
                }
            ],
            images: [
                {
                    prompt: "A serene, futuristic cityscape at dawn, with flying cars and towering glass buildings, digital art.",
                    imageUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"
                },
                {
                    prompt: "A lone astronaut floating in space, looking at a distant, vibrant galaxy, realistic photo.",
                    imageUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4"
                },
                {
                    prompt: "A whimsical forest with bioluminescent mushrooms and glowing fireflies, fantasy painting.",
                    imageUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/WhatCarCanYouGetForAGrand.mp4"
                },
                {
                    prompt: "A majestic lion, with a flowing mane, sitting on a rock in the African savannah, cinematic lighting.",
                    imageUrl: "https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4"
                }
            ]
        };

        function createResultSlot(type, id, prompt) {
            const slot = document.createElement('div');
            const aspectClass = type === 'video' ? (ratioSelect.value === '16:9' ? 'aspect-video' : (ratioSelect.value === '9:16' ? 'aspect-[9/16]' : 'aspect-square')) : (imageRatioSelect.value === '1:1' ? 'aspect-square' : (imageRatioSelect.value === '16:9' ? 'aspect-video' : 'aspect-[9/16]'));
            
            slot.id = id;
            slot.className = `${aspectClass} w-full bg-gray-800 rounded-xl flex items-center justify-center border-2 border-dashed border-gray-700 transition-all duration-300 relative overflow-hidden`;
            
            if (type === 'video') {
                slot.innerHTML = `
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-center text-gray-500 p-4">
                        <p class="mb-2 text-sm text-gray-400">Prompt:</p>
                        <p class="italic text-gray-300">${prompt || 'Masukkan prompt...'}</p>
                    </div>
                    <div class="loader absolute inset-0 hidden"></div>
                    <video class="hidden w-full h-full rounded-xl object-cover" controls autoplay muted loop>
                        <source src="" type="video/mp4">
                        Browser Anda tidak mendukung tag video.
                    </video>
                    <div class="absolute inset-0 hidden text-center text-red-400 font-medium p-4">
                        <i class="fa fa-exclamation-triangle fa-2x mb-2"></i>
                        <p></p>
                    </div>
                `;
            } else if (type === 'image') {
                slot.innerHTML = `
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-center text-gray-500 p-4">
                        <p class="mb-2 text-sm text-gray-400">Prompt:</p>
                        <p class="italic text-gray-300">${prompt || 'Masukkan prompt...'}</p>
                    </div>
                    <div class="loader absolute inset-0 hidden"></div>
                    <img class="hidden w-full h-full rounded-xl object-cover" src="" alt="Generated Image">
                    <div class="absolute inset-0 hidden text-center text-red-400 font-medium p-4">
                        <i class="fa fa-exclamation-triangle fa-2x mb-2"></i>
                        <p></p>
                    </div>
                `;
            }
            return slot;
        }

        function displayGallery() {
            gallery.innerHTML = '';
            sampleData.videos.forEach(item => {
                const card = document.createElement('div');
                card.className = 'relative bg-gray-800 rounded-xl shadow-md overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 cursor-pointer';
                card.innerHTML = `
                    <video class="w-full h-48 object-cover" src="${item.videoUrl}" loop muted></video>
                    <div class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 transition-opacity opacity-100 hover:opacity-0">
                        <i class="fa fa-play text-white text-4xl"></i>
                    </div>
                    <div class="p-4">
                        <p class="text-sm text-indigo-200">${item.prompt}</p>
                    </div>
                `;
                card.onclick = () => {
                    promptsInput.value = item.prompt;
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                card.addEventListener('mouseenter', (event) => {
                    card.querySelector('video').play();
                });
                card.addEventListener('mouseleave', (event) => {
                    const video = card.querySelector('video');
                    video.pause();
                    video.currentTime = 0;
                });
                gallery.appendChild(card);
            });
        }
        
        toggleApiKeyBtn.addEventListener('click', () => {
            const icon = toggleApiKeyBtn.querySelector('i');
            if (apiKeyInput.type === 'password') {
                apiKeyInput.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                apiKeyInput.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });

        saveApiBtn.addEventListener('click', () => {
            if (apiKeyInput.value.trim() !== '') {
                isApiSaved = true;
                apiKeyStatus.textContent = 'API Key berhasil disimpan!';
                apiKeyStatus.style.color = 'rgb(134 239 172)';
                setTimeout(() => {
                    apiKeyStatus.textContent = '';
                }, 3000);
            } else {
                 isApiSaved = false;
                 apiKeyStatus.textContent = 'API Key tidak boleh kosong.';
                 apiKeyStatus.style.color = 'rgb(252 165 165)';
                 setTimeout(() => {
                    apiKeyStatus.textContent = '';
                }, 3000);
            }
        });

        generateBtn.addEventListener('click', () => {
            if (!isApiSaved) {
                globalErrorMessage.classList.remove('hidden');
                globalErrorText.textContent = 'Harap simpan API Key Anda terlebih dahulu.';
                return;
            }
            globalErrorMessage.classList.add('hidden');

            const prompts = promptsInput.value.trim().split('\n').map(p => p.trim()).filter(p => p !== '');
            const selectedModel = modelSelect.value;
            const selectedRatio = ratioSelect.value;
            const selectedResolution = resolutionSelect.value;

            if (prompts.length === 0) {
                globalErrorMessage.classList.remove('hidden');
                globalErrorText.textContent = 'Harap masukkan setidaknya satu prompt.';
                return;
            }

            resultsGrid.innerHTML = '';
            noResultsMessage.classList.add('hidden');
            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-50', 'cursor-not-allowed');

            prompts.forEach((prompt, index) => {
                const resultSlotId = `resultSlot${index + 1}`;
                const slot = createResultSlot('video', resultSlotId, prompt);
                resultsGrid.appendChild(slot);
                
                const slotLoader = slot.querySelector('.loader');
                const slotVideo = slot.querySelector('video');

                slot.querySelector('.text-center').classList.add('hidden');
                slotLoader.classList.remove('hidden');

                setTimeout(() => {
                    const randomVideo = sampleData.videos[Math.floor(Math.random() * sampleData.videos.length)];
                    
                    slotLoader.classList.add('hidden');
                    slotVideo.classList.remove('hidden');
                    slotVideo.src = randomVideo.videoUrl;
                    slotVideo.load();
                    slotVideo.play();
                    
                    if (index === prompts.length - 1) {
                        generateBtn.disabled = false;
                        generateBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    }
                }, 3000 * (index + 1));
            });
        });

        generateImageBtn.addEventListener('click', () => {
            if (!isApiSaved) {
                globalErrorMessage.classList.remove('hidden');
                globalErrorText.textContent = 'Harap simpan API Key Anda terlebih dahulu.';
                return;
            }
            globalErrorMessage.classList.add('hidden');

            const prompts = promptsInput.value.trim().split('\n').map(p => p.trim()).filter(p => p !== '');
            const selectedImageModel = imageModelSelect.value;
            const selectedImageRatio = imageRatioSelect.value;

            if (prompts.length === 0) {
                globalErrorMessage.classList.remove('hidden');
                globalErrorText.textContent = 'Harap masukkan setidaknya satu prompt.';
                return;
            }

            resultsGrid.innerHTML = '';
            noResultsMessage.classList.add('hidden');
            generateImageBtn.disabled = true;
            generateImageBtn.classList.add('opacity-50', 'cursor-not-allowed');

            prompts.forEach((prompt, index) => {
                const resultSlotId = `imageSlot${index + 1}`;
                const slot = createResultSlot('image', resultSlotId, prompt);
                resultsGrid.appendChild(slot);

                const slotLoader = slot.querySelector('.loader');
                const slotImage = slot.querySelector('img');

                slot.querySelector('.text-center').classList.add('hidden');
                slotLoader.classList.remove('hidden');

                setTimeout(() => {
                    const randomImage = sampleData.images[Math.floor(Math.random() * sampleData.images.length)];
                    
                    slotLoader.classList.add('hidden');
                    slotImage.classList.remove('hidden');
                    slotImage.src = randomImage.imageUrl;

                    if (index === prompts.length - 1) {
                        generateImageBtn.disabled = false;
                        generateImageBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    }
                }, 2000 * (index + 1));
            });
        });
        
        visualStyleSelect.addEventListener('change', (event) => {
            if (event.target.value === 'lainnya') {
                customStyleInput.classList.remove('hidden');
            } else {
                customStyleInput.classList.add('hidden');
            }
        });

        generateJsonBtn.addEventListener('click', () => {
            const apiKey = apiKeyInput.value.trim();
            const prompts = promptsInput.value.trim().split('\n').map(p => p.trim()).filter(p => p !== '');
            
            const selectedNumberOfScenes = parseInt(numberOfScenesSelect.value);
            const trimmedPrompts = prompts.slice(0, selectedNumberOfScenes);

            const model = modelSelectJson.value;
            const language = languageSelectJson.value;
            
            let visualStyle = visualStyleSelect.value;
            if (visualStyle === 'lainnya') {
                visualStyle = customStyle.value.trim();
            }

            const sceneData = {
                api_key: apiKey,
                number_of_scenes: trimmedPrompts.length,
                language: language,
                visual_style: visualStyle,
                model: model,
                video_settings: {
                    ratio: ratioSelect.value,
                    resolution: resolutionSelect.value
                },
                prompts: trimmedPrompts.map((p, i) => ({
                    id: `prompt_${i + 1}`,
                    text: p
                }))
            };

            const jsonString = JSON.stringify(sceneData, null, 2);
            jsonOutput.textContent = jsonString;
            jsonOutputSection.classList.remove('hidden');
        });

        copyJsonBtn.addEventListener('click', () => {
            const jsonText = jsonOutput.textContent;
            navigator.clipboard.writeText(jsonText).then(() => {
                alert('JSON berhasil disalin ke clipboard!');
            }).catch(err => {
                console.error('Gagal menyalin:', err);
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            displayGallery();
            noResultsMessage.classList.remove('hidden');
        });
    </script>
</body>
</html>
